<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Skill API Test</title>
</head>
<body>
  <!-- ========== 1. 添加 Skill ========== -->
  <h1>Test /add_skill</h1>
  <form id="skillForm">
    <div>
      <label for="username">Username:</label>
      <input type="text" id="username" name="username" placeholder="如：rex">
    </div>
    <br>
    <div>
      <label for="skillname">Skill name:</label>
      <input type="text" id="skillname" name="skillname" placeholder="如：写作">
    </div>
    <br>
    <div>
      <label for="proficiency">Proficiency:</label>
      <input type="number" id="proficiency" name="proficiency" placeholder="如：2">
    </div>
    <br>
    <button type="submit">添加 Skill</button>
  </form>

  <hr>

  <!-- ========== 2. 删除 Skill ========== -->
  <h1>Test /delete_skill_by_user</h1>
  <form id="deleteSkillForm">
    <div>
      <label for="del_username">Username:</label>
      <input type="text" id="del_username" name="del_username" placeholder="如：rex">
    </div>
    <br>
    <div>
      <label for="del_skillname">Skill name:</label>
      <input type="text" id="del_skillname" name="del_skillname" placeholder="如：写作">
    </div>
    <br>
    <button type="submit">删除 Skill</button>
  </form>

  <hr>

  <!-- ========== 3. 查询指定用户的 Skill ========== -->
  <h1>Test /get_skill_by_user</h1>
  <form id="getSkillForm">
    <div>
      <label for="get_username">Username:</label>
      <input type="text" id="get_username" name="get_username" placeholder="如：rex">
    </div>
    <br>
    <button type="submit">查询 Skill</button>
  </form>


  <!-- ========== JavaScript (使用 fetch) ========== -->
  <script>
    // ========== 1. 添加 Skill ==========
    document.getElementById('skillForm').addEventListener('submit', function(e) {
      e.preventDefault(); // 阻止表单默认提交

      const username = document.getElementById('username').value.trim();
      const skillname = document.getElementById('skillname').value.trim();
      const proficiency = parseInt(document.getElementById('proficiency').value, 10);

      const payload = {
        username: username,
        skillname: skillname,
        proficiency: proficiency
      };

      fetch('https://18.183.175.8/add_skill', { // TODO: 替换成自己的服务器地址
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('添加 Skill 接口返回: ', data);
        alert('添加 Skill 接口返回: ' + JSON.stringify(data));
      })
      .catch(error => {
        console.error('添加 Skill 出现错误:', error);
        alert('出现错误: ' + error);
      });
    });

    // ========== 2. 删除 Skill ==========
    document.getElementById('deleteSkillForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const username = document.getElementById('del_username').value.trim();
      const skillname = document.getElementById('del_skillname').value.trim();

      const payload = {
        skillname: skillname
      };

      fetch(`https://18.183.175.8/delete_skill_by_user/${username}`, { // TODO: 替换成自己的服务器地址
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('删除 Skill 接口返回:', data);
        alert('删除 Skill 接口返回: ' + JSON.stringify(data));
      })
      .catch(error => {
        console.error('删除 Skill 出现错误:', error);
        alert('出现错误: ' + error);
      });
    });

    // ========== 3. 查询指定用户的 Skill ==========
    document.getElementById('getSkillForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const username = document.getElementById('get_username').value.trim();

      fetch(`https://18.183.175.8/get_skill_by_user/${username}`, { // TODO: 替换成自己的服务器地址
        method: 'GET'
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log('查询 Skill 接口返回:', data);
        alert('查询 Skill 接口返回: ' + JSON.stringify(data));
      })
      .catch(error => {
        console.error('查询 Skill 出现错误:', error);
        alert('出现错误: ' + error);
      });
    });
  </script>
</body>
</html>